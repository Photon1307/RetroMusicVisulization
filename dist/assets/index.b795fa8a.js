import{S as Ue,P as Ke,W as Je,C as Qe,G as Ze,M as et,V as tt,a as nt,b as ot,F as it,c as at,d as rt,e as oe,A as st,L as Te,f as Pe,g as xe,R as lt,h as ct,T as z,i as ut}from"./vendor.b0d5a6e9.js";const dt=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))v(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const y of o.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&v(y)}).observe(document,{childList:!0,subtree:!0});function b(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function v(i){if(i.ep)return;i.ep=!0;const o=b(i);fetch(i.href,o)}};dt();var ft="/assets/embrace.15354cf6.mp3",mt="/assets/Vinyl_disc.2f0b5899.glb",yt="/assets/player(1).7f95abca.glb",pt="/assets/cassette.0a33fa07.glb",vt="/assets/vinyl2.20075ff3.glb",gt="/assets/table.95a3570e.glb",ht="/assets/tv.59b4f957.glb",wt="/assets/recorder.822a7a35.glb";document.getElementById("song").src=ft;let ie,j=0,Y=0,r,V=.4,ae=.25,W,h,L=!1,Le,X,I=!1,P=!1,G,U=!1,Ce=!1,Ae,re,Se,u,d,l,se;const Ie=document.getElementById("mic"),C=document.getElementById("PlayButton"),le=document.getElementById("MediaPlayerContainer"),De=document.querySelector(".SongTitle"),F=document.querySelector("#progress-bar");function Mt(){const A=document.querySelector("#c"),n=new Ue,b=new Ke(30,innerWidth/innerHeight,1,5e3),v=new Je({canvas:A});b.position.set(-1.3,.72,1.2),b.lookAt(.35,.45,0),console.log(b),console.log(v),n.background=new Qe(9109504),v.setSize(innerWidth,innerHeight),v.setPixelRatio(devicePixelRatio),v.setClearColor(16777215,1),document.body.appendChild(v.domElement);const i=new ut,o=new Ze(i);o.setMeshoptDecoder(et),i.onLoad=function(){Me(),$("#loading").hide()};let y;o.load(yt,function(e){y=e.scene,n.add(y),y.position.set(0,0,0)});let c;o.load(mt,function(e){c=e.scene,n.add(c),c.name="vinyl",c.position.set(-.117,.3,.03),c.rotation.z=Math.PI/2,c.scale.set(.17,.17,.17)});let w;o.load(gt,function(e){w=e.scene,n.add(w),w.name="table",w.position.set(-6,-1.45,-.4),w.scale.set(.1,.1,.1)});let p;o.load(ht,function(e){p=e.scene,n.add(p),p.name="tv",p.rotation.y=.8*Math.PI,p.position.set(2,.47,-.5),p.scale.set(.0035,.0035,.0035)});let B;o.load(wt,function(e){B=e.scene,n.add(B),B.name="recorder",B.rotation.y=-Math.PI/1.5,B.position.set(1.4,.52,.8),B.scale.set(.003,.003,.003)});let t;o.load(vt,function(e){t=e.scene,n.add(t),t.name="vinyl2",t.rotation.y=Math.PI*1.7,t.position.set(1.1,.29,-.4),t.scale.set(2.7,2.7,2.7)});let a;o.load(pt,function(e){a=e.scene,n.add(a),a.name="cassette",a.rotation.y=Math.PI*1.5,a.position.set(.7,.025,.7),a.scale.set(5e-4,5e-4,5e-4)});const T=document.getElementById("video"),D=new tt(T),S=new nt(.8,.6),H=new ot({map:D,side:it,toneMapped:!1});H.needsUpdate=!0;const q=new at(S,H);n.add(q),q.rotation.y=-.2*Math.PI,q.position.set(1.75,.65,-.23);const O=new rt(16104365,.2);O.position.set(0,.5,0),n.add(O);const m=new oe(14980953,.5);m.castShadow=!0,m.position.set(1.3,.7,.2),n.add(m);const K=new st(4210752);n.add(K);const _=new oe(14980953,1);_.castShadow=!0,n.add(_),_.position.set(0,3,-3);const J=new oe(14980953,1);J.castShadow=!0,n.add(J),J.position.set(3,3,0);const fe=new oe(14980953,1);fe.castShadow=!0,n.add(fe),J.position.set(-3,3,0),console.log(o);function Be(e,f){return Math.random()*(f-e)+e}var E,me,ye=new Te,Q=360,Z=0,He=new Float32Array(Q*3);ye.setPositions(He);var qe=new Pe({color:12205373,linewidth:.004,alphaToCoverage:!0});E=new xe(ye,qe),me=E.clone(),console.log(me),n.add(E),E.position.set(-.19,0,.05),Oe();function Oe(){for(var e=[],f=0,M=0,x=0,g=0,s=0,N=Q;s<N;s+=2)f=Math.sin(s*(Math.PI/180))*V,M=.37,x=Math.cos(s*(Math.PI/180))*V,e[g++]=f,e[g++]=M,e[g++]=x;E.geometry.setPositions(e)}function ke(){for(var e=[],f=0,M=0,x=0,g=0,s=0,N=Q;s<N;s+=2)f=Math.sin(s*(Math.PI/180))*V,Math.sin(s*(Math.PI/30))>0?M=Y*.005*Math.sin(s*(Math.PI/30))+.37:M=Y*.001*Math.sin(s*(Math.PI/5))+Be(.37,.4),x=Math.cos(s*(Math.PI/180))*V,e[g++]=f,e[g++]=M,e[g++]=x;E.geometry.setPositions(e)}var k,ce=360,ee=0,Fe=new Float32Array(ce*3),pe=new Te;pe.setPositions(Fe);var Ne=new Pe({color:6860472,linewidth:.0025,alphaToCoverage:!0});k=new xe(pe,Ne),n.add(k),k.position.set(-.19,0,.05),ze();function ze(){for(var e=[],f=0,M=0,x=0,g=0,s=0,N=ce;s<N;s+=2)f=Math.sin(s*(Math.PI/180))*ae,M=.33,x=Math.cos(s*(Math.PI/180))*ae,e[g++]=f,e[g++]=M,e[g++]=x;k.geometry.setPositions(e)}function _e(){for(var e=[],f=0,M=0,x=0,g=0,s=0,N=360;s<N;s+=2)f=Math.sin(s*(Math.PI/180))*ae,M=Y*.0035*Math.sin(s*j)+.33+Y*.0035,x=Math.cos(s*(Math.PI/180))*ae,e[g++]=f,e[g++]=M,e[g++]=x;k.geometry.setPositions(e)}var ve=0,ge=0,Re=window.innerWidth/2,Ye=window.innerHeight/2;document.addEventListener("mousemove",Ve,!1);function Ve(e){ve=e.clientX-Re,ge=e.clientY-Ye}const te=new lt,R=new ct;let he=[];function We(e){he=[],he.push(e)}var ne=Date.now();function Xe(e){if(Date.now()-ne<60)return;ne=Date.now(),R.x=e.clientX/window.innerWidth*2-1,R.y=-(e.clientY/window.innerHeight)*2+1,te.setFromCamera(R,b);const f=te.intersectObject(t,!0);if(f.length>0){const M=f[0].object;We(M),$.confirm({title:"\u266C ?",content:"Play Music: \u4E94\u6708\u5929 - \u64C1\u62B1.mp3",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"PLAY",btnClass:"btn-gray",action:function(){I&&(de(),I=!1),r!=null&&P&&(r.currentTime=0,r.pause()),console.log("localMusic",P),!P&&u!=null&&u.close(),r=document.querySelector("audio"),Ce||(G=new AudioContext,Ae=G.createMediaElementSource(r),Ce=!0),l=G.createAnalyser(),X=new Uint8Array(l.frequencyBinCount),Ae.connect(l),l.connect(G.destination),r.play(),De.innerHTML="\u64C1\u62B1.mp3",P=!0,U=!1,L=!1,le.style.visibility="visible",C.style.visibility="visible",C.innerHTML="pause",ue(),console.log("DETECTED! Clicking on the vinyl 2")}},close:{text:"Cancel",btnClass:"btn-gray",action:function(){}}}})}be()}let we=[];function $e(e){we=[],we.push(e)}function je(e){Date.now()-ne<300||(ne=Date.now(),e.isPrimary!==!1&&(R.x=e.clientX/window.innerWidth*2-1,R.y=-(e.clientY/window.innerHeight)*2+1,Ge()))}function Ge(){c.isPickable=!1,w.isPickable=!1,a.isPickable=!1,p.isPickable=!1,te.setFromCamera(R,b);const e=te.intersectObject(t,!0);if(e.length>0){$("html,body").css("cursor","pointer");const f=e[0].object;$e(f),new z.Tween(t.position).to({x:1.1,y:.34,z:-.4},300).start(),new z.Tween(t.scale).to({x:2.85,y:2.85,z:2.85},300).easing(z.Easing.Cubic.Out).start()}else $("html,body").css("cursor","default"),new z.Tween(t.position).to({x:1.1,y:.29,z:-.4},300).start(),new z.Tween(t.scale).to({x:2.7,y:2.7,z:2.7},300).easing(z.Easing.Cubic.Out).start()}function Me(){console.log("local",P,"mic",I,"out",U,"paused",L),requestAnimationFrame(Me),c!=null&&(c.rotation.x+=(-ve/12800-c.rotation.x)*.02,c.rotation.y+=(ge/4800-c.rotation.y)*.02),E!=null&&(Z=(Z+60)%Q,E.geometry.maxInstancedCount=Z,Z===0&&ke(),E.rotation.y-=Math.PI/180*.15),k!=null&&(ee=(ee+60)%ce,k.geometry.maxInstancedCount=ee,ee===0&&_e(),k.rotation.y-=Math.PI/180*.1),v.domElement.addEventListener("pointermove",je.bind(this)),v.domElement.addEventListener("click",Xe,!1),z.update(),be()}function be(){v.render(n,b)}}Mt();function ue(){l.getByteFrequencyData(X);for(var A=0,n=0;n<l.frequencyBinCount;n++)X[n]>X[A]&&(A=n);if(P)var b=A*G.sampleRate/l.fftSize;else var b=A*u.sampleRate/l.fftSize;function v(i){for(var o=0,y,c=i.length,w=0;w<c;w++)o+=i[w];return y=o/c,y}Y=v(X),j=(b-20)/1e3,V=j*.07+.4,requestAnimationFrame(ue)}C.onclick=function(){P?L?(r.play(),L=!1,C.innerHTML="pause"):(r.pause(),L=!0,C.innerHTML="resume"):L?(Ee(),C.innerHTML="pause"):(bt(),C.innerHTML="resume")};function de(){u=new AudioContext,l=u.createAnalyser(),d=u.createBufferSource()}F.addEventListener("change",A=>{P?r.currentTime=F.value:(h=F.value*1e3,d.stop(),Ee())});function Ee(){d=u.createBufferSource(),d.connect(l),l.connect(u.destination),d.buffer=Le,d.loop=!1,L=!1,h?(W=Date.now()-h,d.start(0,h/1e3)):(W=Date.now(),d.start(0))}function bt(){d.stop(0),h=Date.now()-W,L=!0}$(document).ready(function(){le.style.visibility="hidden",C.style.visibility="hidden",console.log("Document ready!");const A=document.getElementById("mic");A.onclick=function(){I==!1?b():(de(),I=!1,Ie.innerHTML="Microphone: Off",console.log("Stop mic!",I))};function n(){u=new AudioContext,l=u.createAnalyser(),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(t){u=new AudioContext,d=u.createMediaStreamSource(t),l=u.createAnalyser(),d.connect(l);var a=new Uint8Array(l.frequencyBinCount);function T(){l.getByteFrequencyData(a);for(var D=0,S=0;S<l.frequencyBinCount;S++)a[S]>a[D]&&(D=S);for(var H=0,q=a.length,O=0;O<q;O++)H+=a[O];Y=H/q;var m=D*u.sampleRate/l.fftSize;j=(m-20)/1e3,V=j*.035+.4,requestAnimationFrame(T)}T()}).catch(t=>{console.log(t)})}function b(){$.confirm({title:"Open Mic?",content:"You Will Input Audio From Mic, Say Allo",type:"blue",typeAnimated:!0,buttons:{OK:{text:"OK",btnClass:"btn-gray",action:function(){r!=null&&(le.style.visibility="hidden",C.style.visibility="hidden",P?(r.pause(),r.currentTime=0):d.stop(),r=null,de(),console.log("Stop music!")),I=!0,U=!1,P=!1,Ie.innerHTML="Microphone: On",n(),console.log("Open mic!",I)}},Cancel:{text:"Cancel",btnClass:"btn-gray",action:function(){}}}})}function v(){$.confirm({title:"\u266C ?",content:se.name,type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"PLAY",btnClass:"btn-gray",action:function(){I=!1,P&&(r.pause(),r.currentTime=0,P=!1),U&&d.stop(0),u=new AudioContext,l=u.createAnalyser(),d=u.createBufferSource(),d.connect(l),l.connect(u.destination),C.style.visibility="visible",le.style.visibility="visible",r=se,De.innerHTML=r.name,console.log(r),console.log("File recieved!"),re=new FileReader,h=0,re.readAsArrayBuffer(r),U=!0,re.onload=function(t){Se=re.result,u.decodeAudioData(Se,function(a){ie=a.duration,Le=a,d.buffer=a,d.loop=!1}),L=!1,h?(W=Date.now()-h,d.start(0,h/1e3)):(W=Date.now(),d.start(0)),X=new Uint8Array(l.frequencyBinCount),ue()}}},close:{text:"Cancel",btnClass:"btn-gray",action:function(){I==!0&&n()}}}})}const i=document.getElementById("c");i.addEventListener("dragover",t=>{console.log("over"),t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}),i.addEventListener("drop",t=>{t.stopPropagation(),t.preventDefault(),console.log("drop"),se=t.dataTransfer.files[0],se.type=="audio/mpeg"?v():alert("Please make sure selected file is mp3 format")});function o(){r!=null&&P?(F.max=r.duration,F.value=r.currentTime,document.querySelector(".currentTime").innerHTML=y(Math.floor(r.currentTime)),document.querySelector(".durationTime").innerHTML==="NaN:NaN"?document.querySelector(".durationTime").innerHTML="0:00":document.querySelector(".durationTime").innerHTML=y(Math.floor(r.duration))):(F.max=ie,h!=null?(L||(h+=500),h>ie*1e3&&(h=0,W=0,L=!0,C.innerHTML="Start"),F.value=h/1e3,document.querySelector(".currentTime").innerHTML=y(Math.floor(h/1e3))):(F.value=0,document.querySelector(".currentTime").innerHTML=y(0)),document.querySelector(".durationTime").innerHTML==="NaN:NaN"?document.querySelector(".durationTime").innerHTML="0:00":document.querySelector(".durationTime").innerHTML=y(Math.floor(ie)))}function y(t){let a=Math.floor(t/60),T=Math.floor(t-a*60);return T<10&&(T=`0${T}`),`${a}:${T}`}setInterval(o,500);var c=4,w,p={bottom:0,left:0,right:0,top:0};B(document.getElementById("MediaPlayerContainer"));function B(t){var a=0,T=0,D=0,S=0;document.getElementById(t.id+"header")?document.getElementById(t.id+"header").onmousedown=H:t.onmousedown=H;function H(m){m=m||window.event,D=m.clientX,S=m.clientY,w=t.getBoundingClientRect(),p.bottom=window.innerHeight-c,p.left=c,p.right=window.innerWidth-c,p.top=c,document.onmouseup=O,document.onmousemove=q}function q(m){m=m||window.event,a=D-m.clientX,T=S-m.clientY,D=m.clientX,S=m.clientY;var K=t.offsetLeft-a,_=t.offsetTop-T;K<p.left||_<p.top||K+w.width>p.right||_+w.height>p.bottom||(t.style.top=t.offsetTop-T+"px",t.style.left=t.offsetLeft-a+"px")}function O(){document.onmouseup=null,document.onmousemove=null}}});
